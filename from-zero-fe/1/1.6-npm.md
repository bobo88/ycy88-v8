# npm

`npm`（Node Package Manager）是 JavaScript 生态系统中的包管理工具，广泛应用于 Node.js 项目中，负责管理项目的依赖、版本控制、脚本执行等任务。

::: tip npm 与 node 的关系
`npm`（Node Package Manager）是 Node.js 的官方包管理工具。它是与 Node.js 紧密集成的，专门用于管理 JavaScript 运行环境下的第三方依赖包和模块。它的关系可以从以下几个方面理解：

1. **npm 是 Node.js 的默认包管理器**：

   - 每当安装 Node.js 时，`npm` 会随之自动安装。通过 `npm`，开发者可以轻松安装、管理、共享 JavaScript 代码库。
   - Node.js 运行时环境用于执行 JavaScript 代码，而 `npm` 则管理这些代码依赖。

2. **npm 用于管理 Node.js 项目中的依赖**：

   - 在 Node.js 项目中，`npm` 用于安装依赖（例如安装 Express、Lodash 等库），将其添加到项目中的 `node_modules` 文件夹内，并更新项目根目录的 `package.json` 文件以记录这些依赖。
   - 例如，`npm install express` 会在项目中安装 Express 库，并将其添加到 `package.json` 的 `dependencies` 中。

3. **npm 用于 JavaScript 和前端开发中的工具链**：
   - 在前端开发中，`npm` 同样扮演着重要角色，除了安装 Node.js 模块外，还能用来安装构建工具（如 Webpack、Babel 等）和其他前端依赖库（如 React、Vue 等）。
   - 使用 `npm` 的 `run` 命令可以在 Node.js 环境下运行前端构建脚本、测试脚本等。

:::

## `npm` 对比表格

| 特性           | 描述                                                                               |
| -------------- | ---------------------------------------------------------------------------------- |
| **全称**       | Node Package Manager                                                               |
| **作用**       | 管理 JavaScript 包，安装、升级、发布依赖包                                         |
| **官网**       | [npmjs.com](https://www.npmjs.com/)                                                |
| **包管理**     | 管理第三方库和工具包，简化依赖和版本管理                                           |
| **命令行工具** | 提供命令行工具来安装、卸载、更新依赖包                                             |
| **原理**       | 使用 `package.json` 文件管理依赖，安装依赖时会生成 `node_modules` 目录存放库文件。 |
| **版本管理**   | 支持指定版本范围，可以通过语义版本控制管理依赖关系。                               |
| **注册中心**   | npm 提供公共注册中心，用户可以将自己的包发布到 npm 仓库中。                        |
| **发布包**     | 提供了发布和更新包的功能，便于共享和管理私有包和公共包。                           |

## `npm` 的工作原理

- **包管理**：当你通过 `npm install <package-name>` 命令安装包时，`npm` 会根据 `package.json` 文件中的依赖关系安装指定版本的库，并将它们存储在项目的 `node_modules` 目录下。`npm` 会将库信息和版本保存在 `package-lock.json` 文件中，确保安装的版本一致。
- **语义化版本控制**：`npm` 支持语义版本控制（semver），允许你指定版本范围。包版本通常包含三个部分：`major.minor.patch`。通过 `^` 和 `~` 等符号，你可以设置允许的版本范围。
- **依赖树**：`npm` 使用递归依赖安装机制，逐层解析依赖并将其安装到 `node_modules` 中。如果依赖有多个版本，`npm` 会为每个版本创建独立的目录，避免版本冲突。

## `npm` 命令常用介绍

| 命令                               | 描述                                                                |
| ---------------------------------- | ------------------------------------------------------------------- |
| `npm install <package>`            | 安装指定包，安装时会将包写入 `package.json` 文件的 `dependencies`。 |
| `npm install --save-dev <package>` | 安装开发依赖，仅用于开发环境，不会出现在生产环境中。                |
| `npm uninstall <package>`          | 卸载指定包，并从 `package.json` 中移除。                            |
| `npm update <package>`             | 更新包到最新版本。                                                  |
| `npm run <script>`                 | 执行在 `package.json` 中定义的脚本，如 `npm run build`。            |
| `npm publish`                      | 将本地包发布到 npm 注册中心。                                       |
| `npm init`                         | 初始化一个新的 Node.js 项目，创建 `package.json` 文件。             |

## `npm` 优缺点

| 优点                                                             | 缺点                                                                                    |
| ---------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **庞大的生态系统**：npm 提供了世界上最大的开源软件库。           | **安装速度较慢**：相比于某些工具，如 Yarn，`npm` 安装包的速度较慢，尤其是在初次安装时。 |
| **语义版本控制**：支持语义版本控制，确保库的兼容性。             | **较为复杂的依赖管理**：一些复杂的依赖树可能导致版本冲突，尤其在多版本依赖的情况下。    |
| **方便的包管理**：可以方便地安装、更新和管理项目依赖。           | **缺乏离线安装支持**：虽然 `npm` 支持缓存，但对离线支持的优化没有其他工具如 Yarn 强大。 |
| **脚本支持**：提供了执行项目脚本的功能，提升了自动化的开发体验。 | **性能问题**：由于包的数量增多，npm 的性能在某些情况下可能不如预期。                    |
| **稳定性和安全性**：npm 通过 `npm audit` 提供包安全性检查。      | **不友好的错误提示**：部分错误信息过于简单，调试和排查问题时可能不够直观。              |

## `npm` 的应用场景

1. **项目依赖管理**：在 JavaScript 或 Node.js 项目中，npm 主要用于管理第三方依赖包，确保项目环境的一致性。
2. **开发工具集成**：许多前端工具，如构建工具、编译工具、CSS 预处理器等，都依赖 npm 来安装相关依赖。
3. **自动化脚本执行**：`npm run <script>` 命令可以帮助自动化执行开发过程中常见的任务，例如构建、测试和部署。
4. **发布包**：npm 可以帮助开发者将自己的包或库发布到 npm 注册中心，便于他人使用或在团队中共享。

## 结论

`npm` 是 JavaScript 生态系统中不可或缺的工具，它不仅管理项目的依赖关系，还提供了丰富的脚本支持来简化开发流程。尽管在某些方面可能存在性能问题，但它庞大的社区和生态系统使得它在 JavaScript 世界中占据了举足轻重的地位。
