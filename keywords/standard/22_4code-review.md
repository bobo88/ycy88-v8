# Code Review 规范

::: tip Code Review 规范

1. 前提：统一编辑器、统一编辑器配置、统一开发环境（node 版本等）；
2. 最好的规范是团队自己长出来的：确定规范和标准，团队内达成共识；

:::

## 一、目标和原则

### 1. 目标

确保代码质量和一致性，促进知识共享，提高团队整体水平。具体目标包括：

- 寻找和解决潜在问题：通过审查代码，发现和纠正潜在的错误、漏洞、不一致性或其他问题，以确保代码的功能性和安全性。
- 确保符合标准：代码应符合团队、项目或行业的代码规范和标准，包括编码风格、文档要求、性能标准等。
- 提高可读性：确保代码易于阅读、理解和维护。这包括良好的变量命名、注释和逻辑结构。
- 知识共享：通过审查过程，开发团队可以共享知识和最佳实践，从而提高整个团队的技能水平。
- 减少技术债务：通过及早发现和解决问题，降低项目的技术债务，减少以后的维护成本。
- 提高安全性：确保代码中没有潜在的安全漏洞，减少安全风险。

### 2. 原则

- **普适性原则：** Code Review 是团队协作的重要环节，应该适用于所有代码变更，无论是新增功能、Bug 修复还是性能优化。
- **尊重和开放原则：** Code Review 应该建立在相互尊重和开放的基础上，审查人员提出的建议应该是为了提高代码质量，而不是批评开发人员。
- **学习和持续改进原则：** Code Review 过程中发现的问题和解决方案应该成为团队学习的机会，通过不断改进流程和标准提高整体水平。

## 二、操作流程

### 1、主要流程

1. **发起 Code Review：** 由开发者发起，通常在完成自己的任务后请求 Code Review。
2. **指派 Reviewer：** 团队内其他成员担任 Reviewer，具体人选可以根据经验、领域知识等进行选择。
3. **Review 过程：** Reviewer 审查代码，提出建议、指出问题，与开发者进行讨论，确保代码符合规范和标准。
4. **解决问题：** 开发者根据 Reviewer 的反馈解决问题，可以通过迭代的方式进行多轮 Review 直至问题解决。
5. **通过审核：** Reviewer 确认代码符合要求后，通过 Code Review。

### 2、Code Review 的准则

1. **每次提交必须经过审查：** 保证所有的代码变更都经过审查，无论大小。
2. **自审前提交：** 在发起 Code Review 之前，开发者应对自己的代码进行自审。
3. **遵循规定的审查标准和流程：** 代码审查应按照预定的规则进行，确保一致性和准确性。
4. **问题导向审查：** 审查过程应专注于发现代码中的问题和缺陷，而不是评价开发人员。
5. **建议而非强制修改：** Reviewer 的建议应被视为建议，而非强制性的修改，协商是必要的。
6. **积极参与讨论：** 开发人员在审查中应积极参与讨论，接受他人的反馈和建议。
7. **合适的审查时间：** 确保审查在适当的时间进行，避免影响项目进度。
8. **记录审查结果：** 记录审查结果，及时修复和追踪问题，确保问题得到妥善解决。

## 三、具体实践

### 1、Code Review 范围

- **新增功能的实现**
- **Bug 修复**
- **代码重构**
- **性能优化**

### 2、Checklist 与标准

> 【最好的规范是团队自己长出来的】：待补充完善...

#### 1. 代码结构与风格

- [ ] **缩进和空格：** 代码缩进是否一致，空格使用是否规范。
- [ ] **命名规范：** 变量、函数、类的命名是否符合项目的命名规范。
- [ ] **代码注释：** 代码中是否包含足够的注释，特别是对于复杂逻辑或不明显的部分。
- [ ] **函数和类的长度：** 函数和类的长度是否适中，不宜过长，遵循单一职责原则。

#### 2. 错误处理与异常

- [ ] **错误处理：** 是否存在适当的错误处理机制，确保代码对错误情况有响应。
- [ ] **异常信息：** 异常信息是否清晰，能够帮助定位错误的原因。

#### 3. 代码重复

- [ ] **避免冗余代码：** 是否存在相似或重复的代码块，应该考虑使用函数、类或模块进行封装。

#### 4. 性能优化

- [ ] **前端性能：** 检查前端代码是否经过优化，包括减少 HTTP 请求、资源压缩、懒加载等。
- [ ] **响应时间：** 代码是否能够保证页面加载速度较快。
- [ ] **内存管理：** 是否存在潜在的内存泄漏问题。

#### 5. 可读性

- [ ] **良好的注释：** 注释是否解释了代码的目的、特殊逻辑和注意事项。
- [ ] **有意义的变量和函数命名：** 变量和函数的命名是否具有描述性，能够清晰传达其用途和功能。

#### 6. 安全性

- [ ] **数据验证：** 对用户输入的数据是否进行了充分的验证和过滤。
- [ ] **权限控制：** 是否存在足够的权限控制机制，确保用户只能访问其具备权限的资源。
- [ ] **保密信息处理：** 是否谨慎处理和存储敏感信息，避免明文存储密码等机密数据。

#### 7. 测试覆盖率

- [ ] **单元测试：** 核心逻辑是否经过充分的单元测试，覆盖不同的输入情况和边界条件。
- [ ] **集成测试：** 不同模块之间的集成是否经过测试，确保各模块协同工作的正确性。
- [ ] **功能测试：** 整体功能是否经过测试，模拟真实用户的使用场景。

#### 8. 依赖管理

- [ ] **第三方库版本：** 项目中使用的第三方库的版本是否是最新的稳定版本。
- [ ] **依赖项冲突：** 项目中的依赖项之间是否存在冲突，特别关注升级或更换依赖项时可能引发的问题。

#### 9. 文档

- [ ] **代码文档：** 代码中是否包含足够的内联文档，解释代码的设计思路、算法原理和特殊处理。
- [ ] **项目文档：** 项目文档是否完整，包括项目架构、部署说明、API 文档等。

#### 10. 注释

- [ ] **注释质量：** 注释是否提供有关代码设计和实现的重要信息，确保注释是准确、清晰且及时更新的。
- [ ] **注释量适中：** 避免过多的注释，注释应该提供有价值的信息，而不是显而易见的内容。

#### 11. 可维护性

- [ ] **模块化设计：** 代码是否以模块化的方式组织，每个模块是否执行一个明确定义的任务，遵循单一职责原则。
- [ ] **低耦合高内聚：** 设计是否追求低耦合高内聚，使得代码易于维护和扩展。

#### 12. 版本控制

- [ ] **提交信息规范：** 提交代码时，提交信息是否清晰、明了，能够反映出代码变更的目的。
- [ ] **分支管理：** 分支管理策略是否合理，确保使用合适的分支进行开发、测试和发布。

## 四、复盘优化

### 1、效果分析

分析 Code Review 对代码质量和团队学习的影响。

### 2、优化改进措施

#### 2.1 定期培训

定期进行 Code Review 培训，分享最佳实践、新的工具和技术。

#### 2.2 定制化 Checklists

根据项目特点和经验总结，定制化 Checklists，更好地适应团队需求。

#### 2.3 引入自动化工具

探索并引入适用的自动化工具，提高 Code Review 的效率和准确性。

#### 2.4 增加新成员引导

为新成员提供更详细的引导，帮助其更快适应 Code Review 流程和标准。

#### 2.5 制定奖惩机制

建立 Code Review 奖惩机制，激励成员更积极参与，提高 Code Review 的质量。

## 五、奖惩机制

引入奖惩机制，以激励团队成员更积极参与 Code Review，并提高 Code Review 的质量。具体奖惩措施待团队内讨论和制定。

<!-- ## 一、目标

1. **寻找潜在问题：** 通过审查代码，发现和纠正潜在的错误、漏洞、不一致性或其他问题，以确保代码的功能性和安全性。
2. **确保符合标准：** 确保代码符合团队、项目或行业的代码规范和标准，包括编码风格、文档要求、性能标准等。
3. **提高可读性：** 确保代码易于阅读、理解和维护。这包括良好的变量命名、注释和逻辑结构。
4. **知识共享：** 通过审查过程，开发团队可以共享知识和最佳实践，从而提高整个团队的技能水平。
5. **减少技术债务：** 通过及早发现和解决问题，降低项目的技术债务，减少以后的维护成本。
6. **提高安全性：** 确保代码中没有潜在的安全漏洞，减少安全风险。

## 二、checklist

## 1、清单范围

**A、代码质量:**

- **代码风格一致性：** 确保整个项目的代码风格一致，包括缩进、变量命名、注释等。
- **错误和异常处理：** 检查代码中的错误处理和异常处理机制，确保应对潜在问题。
- **DRY 原则（不要重复自己）：** 确保避免重复的代码块，鼓励代码的重用。

**B、性能优化:**

- **前端性能：** 检查前端代码是否经过优化，例如减少 HTTP 请求、压缩资源、懒加载等。
- **响应时间：** 确保页面加载速度较快，不会导致用户等待过长时间。
- **内存管理：** 检查内存泄漏问题，确保前端应用在长时间运行后不会变得缓慢或不稳定。

**C、可维护性:**

- **模块化和组织：** 确保前端代码以模块化的方式组织，易于理解和维护。
- **注释和文档：** 检查代码是否有足够的注释和文档，以帮助其他开发人员理解代码的作用。
- **清晰的变量和函数命名：** 使用有意义的变量和函数命名，以提高代码的可读性。

**D、项目结构:**

- **文件组织：** 确保项目文件结构清晰有序，易于导航。
- **依赖管理：** 确保第三方依赖项的管理是有效的，并且不会导致冲突或安全漏洞。

## 2、具体清单列表

> TODO

## 三、参与人员

前端开发人员

## 四、周期

1 次/周

## 五、审查范围

公司 XX 项目等

## 六、反馈与改进意见

- **可读性：** 高质量的代码应该容易阅读和理解。代码应具备良好的缩进、一致的命名约定、有意义的变量和函数名，并应该包含适量的注释来解释复杂的逻辑。
- **模块化：** 代码应该被拆分为小的、独立的模块，每个模块应该处理一个特定的任务或功能。这有助于代码的复用、测试和维护。
- **一致性：** 代码应该遵循一致的编码风格和标准。这包括缩进风格、变量命名规则、注释约定等。一致的代码更易于阅读和维护。
- **错误处理：** 高质量的代码应该有适当的错误处理机制，能够应对可能出现的异常情况。这包括错误消息的记录和适当的用户反馈。
- **性能：** 代码应具备良好的性能。这包括避免不必要的重复操作、减少资源消耗、使用适当的数据结构和算法，以及避免过多的网络请求。
- **安全性：** 代码应该具备一定的安全性，能够抵御常见的安全攻击，如跨站脚本（XSS）和 SQL 注入。
- **测试覆盖率：** 高质量的代码应该经过充分的测试，包括单元测试、集成测试和功能测试。测试应该覆盖各种代码路径和边界条件。
- **依赖管理：** 代码中的依赖项应该得到有效的管理，确保它们的版本兼容性和安全性。
- **文档：** 代码应该伴随清晰的文档，解释了代码的使用和功能，以便其他开发人员理解和使用。
- **注释：** 注释应该提供有关代码的重要信息，但不应过多。注释应该用于解释为什么代码这样写，而不是代码是什么。
- **可维护性：** 高质量的代码应该易于维护和扩展。代码的修改不应该引发不必要的副作用，而且应该易于找到和修复问题。
- **代码重复：** 避免重复的代码块。代码应该被设计为可重用，以减小代码库的维护工作。
- **代码规范：** 高质量的代码应符合团队或项目的编码规范和最佳实践。
- **版本控制：** 代码应该得到适当的版本控制，以追踪和记录变更。
- **单一职责原则：** 每个函数或模块应该执行一个明确定义的任务，遵循单一职责原则。 -->

---

- [我是如何带领团队从零到一建立前端规范的？](https://www.developers.pub/article/1122112)
- [如何建立 Code Review 规范](https://juejin.cn/post/7222168962775138363)
- [前端 CodeReview 流程及开发基础标准](https://www.jianshu.com/p/3c486436afa6)
<!-- - [数栈前端项目的 Code Review 实践小结](https://www.dtstack.com/bbs/article/529)
- [干货！前端 Code Review 的最佳实践方案](https://segmentfault.com/a/1190000040450153)
- [代码规范](https://woai3c.gitee.io/introduction-to-front-end-engineering/02.html#%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83) -->
